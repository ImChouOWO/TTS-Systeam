{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects\\\\TTS-Systeam\\\\web-tts\\\\src\\\\compoment\\\\page\\\\ragFileUploader.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport io from 'socket.io-client';\nimport '../css/mainPage.css'; // 确保导入了正确的 CSS 文件\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FileUploader = props => {\n  _s();\n  const dataFromParent = props.data;\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [uploadStatus, setUploadStatus] = useState('');\n  const [fileLabel, setFileLabel] = useState('選擇RAG相關文件');\n  const [socket, setSocket] = useState(null);\n  const [userID, setID] = useState(\"test_1\");\n  useEffect(() => {\n    const newSocket = io('http://127.0.0.1:5000');\n    setSocket(newSocket);\n    return () => newSocket.disconnect();\n  }, []);\n  const handleFileChange = event => {\n    const file = event.target.files[0];\n    setSelectedFile(file);\n    if (file) {\n      setFileLabel('準備上傳: ' + file.name);\n    } else {\n      setFileLabel('選擇RAG相關文件');\n    }\n  };\n  const handleFileUpload = () => {\n    if (!selectedFile) {\n      setUploadStatus('No file selected');\n      setFileLabel('選擇失败');\n      return;\n    }\n    const formData = new FormData();\n    formData.append('file', selectedFile);\n    formData.append('userID', userID);\n    formData.append('chatHistory', JSON.stringify(dataFromParent));\n    fetch('http://127.0.0.1:5000/txt_upload', {\n      method: 'POST',\n      body: formData\n    }).then(response => {\n      if (!response.ok) {\n        console.log('Response not OK:', response); // 调试信息\n        throw new Error('Network response was not ok');\n      }\n      return response.json();\n    }).then(data => {\n      console.log('Server response data:', data); // 调试信息\n      if (data.error) {\n        throw new Error(data.error);\n      }\n      setUploadStatus('File uploaded successfully');\n      setFileLabel('選擇RAG相關文件');\n    }).catch(error => {\n      console.error('Upload error:', error); // 调试信息\n      setUploadStatus('File upload failed');\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"file-uploader\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      accept: \".txt\",\n      id: \"file-input\",\n      className: \"input-file\",\n      onChange: handleFileChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"file-input\",\n      className: \"input-label\",\n      children: fileLabel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"button\",\n      onClick: handleFileUpload,\n      children: \"Upload TXT File\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n_s(FileUploader, \"9h7pYyZMzCc0ZR7EuojTw854FlU=\");\n_c = FileUploader;\nexport default FileUploader;\nvar _c;\n$RefreshReg$(_c, \"FileUploader\");","map":{"version":3,"names":["React","useState","useEffect","io","jsxDEV","_jsxDEV","FileUploader","props","_s","dataFromParent","data","selectedFile","setSelectedFile","uploadStatus","setUploadStatus","fileLabel","setFileLabel","socket","setSocket","userID","setID","newSocket","disconnect","handleFileChange","event","file","target","files","name","handleFileUpload","formData","FormData","append","JSON","stringify","fetch","method","body","then","response","ok","console","log","Error","json","error","catch","className","children","type","accept","id","onChange","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","onClick","_c","$RefreshReg$"],"sources":["C:/Projects/TTS-Systeam/web-tts/src/compoment/page/ragFileUploader.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport io from 'socket.io-client';\r\nimport '../css/mainPage.css';  // 确保导入了正确的 CSS 文件\r\n\r\nconst FileUploader = (props) => {\r\n  const dataFromParent = props.data;\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [uploadStatus, setUploadStatus] = useState('');\r\n  const [fileLabel, setFileLabel] = useState('選擇RAG相關文件');\r\n  const [socket, setSocket] = useState(null);\r\n  const [userID, setID] = useState(\"test_1\");\r\n\r\n  useEffect(() => {\r\n    const newSocket = io('http://127.0.0.1:5000');\r\n    setSocket(newSocket);\r\n    return () => newSocket.disconnect();\r\n  }, []);\r\n\r\n  const handleFileChange = (event) => {\r\n    const file = event.target.files[0];\r\n    setSelectedFile(file);\r\n    if (file) {\r\n      setFileLabel('準備上傳: ' + file.name);\r\n    } else {\r\n      setFileLabel('選擇RAG相關文件');\r\n    }\r\n  };\r\n\r\n  const handleFileUpload = () => {\r\n    if (!selectedFile) {\r\n      setUploadStatus('No file selected');\r\n      setFileLabel('選擇失败');\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('file', selectedFile);\r\n    formData.append('userID', userID);\r\n    formData.append('chatHistory', JSON.stringify(dataFromParent));\r\n\r\n    fetch('http://127.0.0.1:5000/txt_upload', {\r\n      method: 'POST',\r\n      body: formData,\r\n    })\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        console.log('Response not OK:', response);  // 调试信息\r\n        throw new Error('Network response was not ok');\r\n      }\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      console.log('Server response data:', data);  // 调试信息\r\n      if (data.error) {\r\n        throw new Error(data.error);\r\n      }\r\n      setUploadStatus('File uploaded successfully');\r\n      setFileLabel('選擇RAG相關文件');\r\n    })\r\n    .catch(error => {\r\n      console.error('Upload error:', error);  // 调试信息\r\n      setUploadStatus('File upload failed');\r\n      \r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className='file-uploader'>\r\n      <input \r\n        type='file' \r\n        accept='.txt' \r\n        id='file-input'\r\n        className='input-file'\r\n        onChange={handleFileChange} \r\n      />\r\n\r\n      <label htmlFor='file-input' className='input-label'>{fileLabel}</label>\r\n      <button className='button' onClick={handleFileUpload}>Upload TXT File</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FileUploader;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}