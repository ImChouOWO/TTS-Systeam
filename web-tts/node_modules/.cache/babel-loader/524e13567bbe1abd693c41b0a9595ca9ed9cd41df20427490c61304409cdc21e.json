{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Owner\\\\Desktop\\\\python\\\\TTS-systeam\\\\voice\\\\web-tts\\\\src\\\\compoment\\\\page\\\\live2d.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport { Application } from '@pixi/app';\nimport { Renderer } from '@pixi/core';\nimport { Ticker, TickerPlugin } from '@pixi/ticker';\nimport { InteractionManager } from '@pixi/interaction';\nimport { Live2DModel, MotionPreloadStrategy } from 'pixi-live2d-display';\nimport Cookies from 'js-cookie';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Live2DComponent({\n  parentRef\n}) {\n  _s();\n  const canvasRef = useRef(null);\n  useEffect(() => {\n    const newSocket = io('http://127.0.0.1:5000');\n    setSocket(newSocket);\n    return () => {\n      newSocket.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    // 注册必要的 PIXI 插件\n    const {\n      offsetWidth,\n      offsetHeight\n    } = parentRef.current;\n    Live2DModel.registerTicker(Ticker);\n\n    // 为 Application 注册 Ticker\n    Application.registerPlugin(TickerPlugin);\n\n    // 注册 InteractionManager 以支持 Live2D 模型的自动交互\n    Renderer.registerPlugin('interaction', InteractionManager);\n    const canvas = canvasRef.current;\n    const app = new Application({\n      backgroundAlpha: 0,\n      view: canvas,\n      width: offsetWidth,\n      height: offsetHeight\n    });\n\n    // 加载 Live2D 模型\n\n    Live2DModel.from('/live2d/shizuku.model.json', {\n      autoInteract: false,\n      motionPreload: MotionPreloadStrategy.IDLE\n    }).then(model => {\n      // 确保 app 和 app.stage 存在\n      if (app && app.stage) {\n        app.stage.addChild(model);\n\n        // 设置模型的初始位置和大小\n        model.anchor.set(0.6, 0.5);\n        model.scale.set(0.3, 0.3);\n        model.position.set(offsetWidth / 3, offsetHeight / 2);\n\n        // 添加交互逻辑\n        canvas.addEventListener('pointerdown', event => {\n          model.focus(event.clientX, event.clientY);\n          model.tap(event.clientX, event.clientY);\n        });\n        canvas.addEventListener('pointermove', event => {\n          if (event.buttons === 1) {\n            model.focus(event.clientX, event.clientY);\n          }\n        });\n      }\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    className: \"live2dCanva\",\n    ref: canvasRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 10\n  }, this);\n}\n_s(Live2DComponent, \"1O11hef6JMAr7xpSnL0aZ5Ib60Q=\");\n_c = Live2DComponent;\nexport default Live2DComponent;\nvar _c;\n$RefreshReg$(_c, \"Live2DComponent\");","map":{"version":3,"names":["React","useEffect","useRef","Application","Renderer","Ticker","TickerPlugin","InteractionManager","Live2DModel","MotionPreloadStrategy","Cookies","jsxDEV","_jsxDEV","Live2DComponent","parentRef","_s","canvasRef","newSocket","io","setSocket","disconnect","offsetWidth","offsetHeight","current","registerTicker","registerPlugin","canvas","app","backgroundAlpha","view","width","height","from","autoInteract","motionPreload","IDLE","then","model","stage","addChild","anchor","set","scale","position","addEventListener","event","focus","clientX","clientY","tap","buttons","className","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Owner/Desktop/python/TTS-systeam/voice/web-tts/src/compoment/page/live2d.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport { Application } from '@pixi/app';\r\nimport { Renderer } from '@pixi/core';\r\nimport { Ticker, TickerPlugin } from '@pixi/ticker';\r\nimport { InteractionManager } from '@pixi/interaction';\r\nimport { Live2DModel, MotionPreloadStrategy } from 'pixi-live2d-display';\r\nimport Cookies from 'js-cookie';\r\n\r\n\r\nfunction Live2DComponent({ parentRef }) {\r\n  const canvasRef = useRef(null);\r\n  useEffect(() => {\r\n    const newSocket = io('http://127.0.0.1:5000');\r\n      setSocket(newSocket);\r\n\r\n      return () => {\r\n        newSocket.disconnect();\r\n      };\r\n    }, []);\r\n \r\n  useEffect(() => {\r\n    // 注册必要的 PIXI 插件\r\n    const { offsetWidth, offsetHeight } = parentRef.current;\r\n    Live2DModel.registerTicker(Ticker);\r\n\r\n    // 为 Application 注册 Ticker\r\n    Application.registerPlugin(TickerPlugin);\r\n\r\n    // 注册 InteractionManager 以支持 Live2D 模型的自动交互\r\n    Renderer.registerPlugin('interaction', InteractionManager);\r\n\r\n    const canvas = canvasRef.current;\r\n    \r\n    const app = new Application({\r\n      backgroundAlpha: 0,\r\n      view: canvas,\r\n      width:offsetWidth,\r\n      height: offsetHeight,\r\n    });\r\n    \r\n    // 加载 Live2D 模型\r\n    \r\n    Live2DModel.from('/live2d/shizuku.model.json', {\r\n        autoInteract: false,\r\n        motionPreload: MotionPreloadStrategy.IDLE\r\n      }).then(model => {\r\n        // 确保 app 和 app.stage 存在\r\n        if (app && app.stage) {\r\n          app.stage.addChild(model);\r\n      \r\n          // 设置模型的初始位置和大小\r\n          model.anchor.set(0.6, 0.5);\r\n          model.scale.set(0.3, 0.3);\r\n          model.position.set(offsetWidth/3, offsetHeight / 2);\r\n      \r\n          // 添加交互逻辑\r\n          canvas.addEventListener('pointerdown', (event) => {\r\n            model.focus(event.clientX, event.clientY);\r\n            model.tap(event.clientX, event.clientY);\r\n          });\r\n      \r\n          canvas.addEventListener('pointermove', (event) => {\r\n            if (event.buttons === 1) {\r\n              model.focus(event.clientX, event.clientY);\r\n            }\r\n          });\r\n        }\r\n      });\r\n      \r\n  }, []);\r\n\r\n  return <canvas className='live2dCanva' ref={canvasRef} />;\r\n}\r\n\r\nexport default Live2DComponent;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}